# Vartotojo sƒÖsajos funkcijos

## üé® Teksto ≈æymƒójimo vizualizacija

### Apra≈°ymas
Interaktyvi teksto analizƒós sistema, kuri spalv≈≥ kodais pa≈æymi propagandos technikas tekste ir suteikia galimybƒô palyginti skirting≈≥ ≈°altini≈≥ anotacijas.

### Funkcionalumas

#### AI vs Ekspert≈≥ anotacijos
- **AI View**: Rodo automati≈°kai aptiktas propagandos technikas i≈° LLM modeli≈≥
  - **Modeli≈≥ pasirinkimas**: Galimybƒó pasirinkti konkret≈≥ AI modelƒØ arba rodyti vis≈≥ modeli≈≥ suvienytus rezultatus
  - **"Visi modeliai" re≈æimas**: Apjungia anotacijas i≈° vis≈≥ modeli≈≥, rodo technikas aptiktas bent vieno modelio
  - **Suvestinƒó anotacij≈≥**: Agregacija vyksta realiu laiku, kad b≈´t≈≥ matomas bendras vaizdas
- **Expert View**: Rodo ekspert≈≥ rankiniu b≈´du sukurtas anotacijas (Label Studio formatas)
- **Toggle perjungimas**: Greitas persijungimas tarp skirting≈≥ anotacij≈≥ tip≈≥
- **Spalvojimo valdymas**: Galimybƒó ƒØjungti/i≈°jungti anotacij≈≥ spalvojimƒÖ (nutylƒótu i≈°jungta)

#### Spalv≈≥ kodavimas
Kiekviena ATSPARA propagandos technika turi unikal≈≥ spalvos kodƒÖ:

| Technika | Spalva | Apra≈°ymas |
|----------|--------|-----------|
| `emotionalAppeal` | #ff6b6b | Apeliavimas ƒØ jausmus |
| `appealToFear` | #ff8e53 | Apeliavimas ƒØ baimƒô |
| `loadedLanguage` | #4ecdc4 | Vertinamoji leksika |
| `nameCalling` | #45b7d1 | Etiketi≈≥ klijavimas |
| `exaggeration` | #96ceb4 | Perdƒótas vertinimas |
| `glitteringGeneralities` | #ffeaa7 | Blizgantys apibendrinimai |
| `whataboutism` | #dda0dd | Whataboutism |
| `redHerring` | #98d8c8 | Red Herring |
| `strawMan` | #f7dc6f | Straw Man |
| `causalOversimplification` | #bb8fce | Supaprastinimas |

#### Interaktyvi legenda
- **Dinaminƒó legenda**: Rodo tik tas technikas, kurios buvo aptiktos konkreƒçiame tekste
- **Apra≈°ymai**: Paai≈°kinimas apie kiekvienƒÖ propagandos technikƒÖ lietuvi≈≥ kalba
- **Spalv≈≥ indikatoriai**: Vizualus ry≈°ys tarp legendos ir pa≈æymƒóto teksto

#### API integracija
- **Real-time ƒØkƒólimas**: Anotacijos gaunamos per `/api/text-annotations/{id}` endpoint
- **Modeli≈≥ filtracija**: API palaiko `model` parametrƒÖ konkretaus modelio anotacijoms gauti
- **Progreso indikatorius**: Loading spinner duomen≈≥ ƒØkƒólimo metu
- **Klaidos valdymas**: Ai≈°k≈´s prane≈°imai apie nepavykusius u≈æklausas
- **Tooltips palaikimas**: Detal≈´s propagandos technik≈≥ apra≈°ymai Bootstrap tooltips

### Techninis sprendimas
```javascript
// Automatinis teksto ≈æymƒójimas su anotacijomis
function displayHighlightedText(content, annotations, legend) {
    // Surikiuoja anotacijas pagal pozicijƒÖ
    const sortedAnnotations = [...annotations].sort((a, b) => a.start - b.start);
    
    // Sukuria HTML su spalv≈≥ kodais
    let highlightedContent = '';
    let lastIndex = 0;
    
    sortedAnnotations.forEach(annotation => {
        const color = techniqueColors[annotation.technique] || '#cccccc';
        highlightedContent += escapeHtml(content.substring(lastIndex, annotation.start));
        highlightedContent += `<span class="highlighted-annotation" 
                                     style="background-color: ${color}; padding: 2px 4px;"
                                     title="${annotation.technique}">${escapeHtml(annotation.text)}</span>`;
        lastIndex = annotation.end;
    });
}
```

## üìù Tekst≈≥ anotacij≈≥ modalinƒó per≈æi≈´ra

### Apra≈°ymas
Kiekvienam tekstui galima atidaryti detal≈≥ modalinƒØ langƒÖ su visomis anotacijomis ir interaktyviais valdymo elementais. Tekst≈≥ analizƒós funkcionalumas perkeltas i≈° pagrindinio puslapio ƒØ modalines per≈æi≈´ras geresniam naudojimo patirtiai.

### Funkcionalumas

#### Modalinƒó per≈æi≈´ra (Detalƒós)
- **Pilnas teksto turinys**: Rodomas tekstas su galimybe plƒósti visƒÖ turinƒØ
- **Tekst≈≥ analizƒós sekcija**: Integruota ƒØ modalinƒØ langƒÖ su pilnu anotacij≈≥ valdymu
- **Kontrolinƒó panelƒó**: AI/ekspert≈≥ anotacij≈≥ perjungimas, modeli≈≥ pasirinkimas, spalvojimo valdymas
- **Dinaminƒó legenda**: Rodo tik aptiktas propagandos technikas konkreƒçiame tekste

#### Anotacij≈≥ valdymas
- **Modeli≈≥ filtracija**: Dropdown su visais analizei naudotais modeliais
- **Toggle funkcijos**:
  - AI anotacijos / Ekspert≈≥ anotacijos
  - Spalvojimo ƒØjungimas/i≈°jungimas ("Rodyti anotacijas")
- **Tooltips**: Hover efektai su detaliais technik≈≥ apra≈°ymais
- **Real-time perjungimas**: Momentinis atsakas keiƒçiant parametrus

#### Plƒótinio lentelƒóje per≈æi≈´ra
- **"Daugiau" mygtukas**: Atskleid≈æia pilnƒÖ tekstƒÖ tiesiai lentelƒóje
- **Supaprastinta kontrolƒós**: Greitasis anotacij≈≥ valdymas be atskir≈≥ modal≈≥
- **Sinchronizuotas valdymas**: Anotacij≈≥ parametrai saugomi per sesij≈≥

#### Interaktyvumas
```javascript
// Modal text view inicializacija
function initializeModalTextHighlighting() {
    // Automatinis modal≈≥ anotacij≈≥ inicializavimas
    document.querySelectorAll('[id^="analysisModal"]').forEach(modal => {
        modal.addEventListener('shown.bs.modal', function() {
            const textAnalysisId = this.id.replace('analysisModal', '');
            loadModalTextAnnotations(textAnalysisId);
        });
    });
    
    // Event listeners modal kontrolƒóms
    document.querySelectorAll('[name^="modalViewType-"]').forEach(radio => {
        radio.addEventListener('change', function() {
            const textAnalysisId = this.name.replace('modalViewType-', '');
            loadModalTextAnnotations(textAnalysisId);
        });
    });
}

// Expanded table view funkcionalumas
function initializeExpandedTextView(textId) {
    const viewToggle = document.getElementsByName(`expandedViewType-${textId}`);
    const modelSelect = document.getElementById(`ai-model-select-${textId}`);
    const annotationToggle = document.getElementById(`annotation-toggle-${textId}`);
    
    // Event listeners anotacij≈≥ perkrovimui
    viewToggle.forEach(radio => {
        radio.addEventListener('change', () => loadExpandedTextAnnotations(textId));
    });
}
```

#### API parametr≈≥ palaikymas
- **`enabled` parametras**: Kontroliuoja anotacij≈≥ rodymo/slƒópimo funkcijƒÖ (nutylƒótu: `true`)
- **`model` parametras**: Leid≈æia pasirinkti konkret≈≥ AI modelƒØ anotacijoms ("all" rodo vis≈≥ modeli≈≥ agregacijƒÖ)
- **`view` parametras**: Persijungia tarp AI ir ekspert≈≥ anotacij≈≥ ("ai" arba "expert")
- **Klaidos valdymas**: Ai≈°k≈´s prane≈°imai apie nepavykusius u≈æklausas ar tr≈´kstamus duomenis

#### Numatytasis b≈´vissavumas (Updated)
- **Anotacij≈≥ rodymas**: Pagal nutylƒójimƒÖ i≈°jungtas - reikia paspausti "Rodyti anotacijas"
- **Modeli≈≥ pasirinkimas**: Paslepta, kol anotacijos neƒØjungtos
- **Ekspert≈≥ anotacijos**: Automati≈°kai aptinka Label Studio formato anotacijas
- **Legenda**: Rodoma tik kada anotacijos ƒØjungtos ir yra aptikt≈≥ technik≈≥

## üìä Dashboard grafik≈≥ sistema

### Chart.js integracija
Sistema naudoja Chart.js bibliotekƒÖ interaktyviems grafikams kurti:

#### Modeli≈≥ na≈°umo palyginimas
- **Bar Chart**: Rodo precision, recall ir F1 score metrkas kiekvienam modeliui
- **Interaktyv≈´s elementai**: Hover tooltips su detaliais duomenimis
- **Responsyvus dizainas**: Prisitaiko prie ekrano dyd≈æio

#### Technik≈≥ pasiskirstymas
- **Doughnut Chart**: Vizualizuoja da≈æniausiai aptiktas propagandos technikas
- **Spalv≈≥ kodavimas**: Atitinka teksto ≈æymƒójimo spalvas
- **Legenda**: Rodo technik≈≥ procentinƒØ pasiskirstymƒÖ

#### Statistik≈≥ eksportas
- **JSON formatas**: Pilni duomenys programiniam apdorojimui
- **CSV formatas**: Duomenys Excel analizei
- **Excel formatas**: Formatuoti duomenys su stiliais

### Konfig≈´racija
```javascript
// Chart.js konfig≈´racija modeli≈≥ na≈°umui
const performanceChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: modelNames,
        datasets: [{
            label: 'F1 Score (%)',
            data: f1Scores,
            backgroundColor: 'rgba(54, 162, 235, 0.7)'
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: {
                beginAtZero: true,
                max: 100
            }
        }
    }
});
```

## üîç Paie≈°kos ir filtravimo sistema

### Real-time paie≈°ka
- **Tikslus atitikimas**: Ie≈°ko pagal analizƒós pavadinimƒÖ, ID ir apra≈°ymƒÖ
- **Momentinis atsakas**: JavaScript filtravimas be serverio u≈æklaus≈≥
- **≈Ωymƒójimas**: Nƒóra rezultat≈≥ prane≈°imas su ai≈°kiais veiksmais

### Filtravimo kategorijos

#### Status≈≥ filtras
| Status | Apra≈°ymas |
|--------|-----------|
| `completed` | Sƒókmingai baigtos analizƒós |
| `processing` | ≈†iuo metu vykdomos analizƒós |
| `failed` | Nepavykusios analizƒós |
| `pending` | Laukianƒçios eilƒóje analizƒós |

#### Tip≈≥ filtras
| Tipas | Apra≈°ymas |
|-------|-----------|
| `standard` | Standartinis ATSPARA prompt |
| `custom` | Vartotojo sukurtas prompt |
| `repeat` | Pakartotinƒó analizƒó |

### JavaScript implementacija
```javascript
function applyFilters() {
    const searchTerm = searchInput.value.toLowerCase();
    const statusValue = statusFilter.value;
    const typeValue = typeFilter.value;
    
    analysisCards.forEach(card => {
        let visible = true;
        
        // Paie≈°kos filtras
        if (searchTerm) {
            const cardText = card.textContent.toLowerCase();
            visible = visible && cardText.includes(searchTerm);
        }
        
        // Status≈≥ filtras
        if (statusValue && visible) {
            const statusBadge = card.querySelector('.badge');
            visible = visible && statusBadge.className.includes(`badge-${statusValue}`);
        }
        
        card.style.display = visible ? 'block' : 'none';
    });
}
```

## üéõÔ∏è Vartotojo patirtis (UX)

### Responsive dizainas
- **Mobile-first**: Prisitaiko prie telefon≈≥ ekran≈≥
- **Tablet optimizacija**: Efektyvus naudojimas plan≈°etƒóse
- **Desktop funkcionalumas**: Pilnas funkcionalumas didesnƒós rai≈°kos ekranuose

### Accessibility (prieinamumas)
- **Klaviat≈´ros navigacija**: Tab key support visoms interaktyvioms funkcijoms
- **Screen reader support**: ARIA labels ir descriptions
- **Spalv≈≥ kontrastas**: WCAG 2.1 standart≈≥ atitiktis
- **Tooltip pagalba**: Papildomi paai≈°kinimai visoms funkcijoms

### Na≈°umo optimizacija
- **Lazy loading**: Anotacijos kraunamos tik kai reikia
- **Client-side filtering**: Greitas atsakas be serverio u≈æklaus≈≥
- **Optimizuoti grafik≈≥ renderiai**: Chart.js performance settings
- **Minimali DOM manipuliacija**: Efektyvus JavaScript kodas

## üîß Konfig≈´racija ir plƒótojimas

### Spalv≈≥ temos pritaikymas
Spalv≈≥ schema yra konfig≈´ruojama `techniqueColors` objekte:

```javascript
const techniqueColors = {
    'emotionalAppeal': '#ff6b6b',
    'appealToFear': '#ff8e53',
    // ... kitos technikos
};
```

### Nauj≈≥ funkcij≈≥ pridƒójimas
1. **Naujos technikos**: Pridƒóti spalvƒÖ ƒØ `techniqueColors` ir apra≈°ymƒÖ ƒØ `getTechniqueDescription`
2. **Nauji grafikai**: Sukurti Chart.js instancijƒÖ su reikiamais duomenimis
3. **Nauji filtrai**: Pridƒóti naujƒÖ select elementƒÖ ir filtr≈≥ logikƒÖ

### API endpoint≈≥ plƒótimas
Nauji anotacij≈≥ tipai gali b≈´ti pridƒóti per `/api/text-annotations` endpoint pridedant naujƒÖ `view` parametro reik≈°mƒô.

### Testavimas
Sistema turi i≈°samius testus:
- **Browser testai**: `TextAnnotationInteractionTest` testuoja pilnƒÖ UI funkcionalumƒÖ
- **API testai**: `TextAnnotationsTest` testuoja backend endpointus
- **Integracijos testai**: Patikrina modeli≈≥ selektori≈≥, anotacij≈≥ toggle, ekspert≈≥ anotacij≈≥ format≈≥

---

≈†ios funkcijos sudaro modern≈≥, interaktyv≈≥ vartotojo sƒÖsajƒÖ propagandos analizƒós sistemai, suteikiant tyrƒójams ir praktikams intuityvius ƒØrankius lietuvi≈°ko teksto analizei.